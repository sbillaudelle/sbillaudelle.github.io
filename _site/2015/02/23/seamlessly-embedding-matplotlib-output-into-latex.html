<!DOCTYPE html>
<html class="no-js">

  <head>
	<meta charset="utf-8">
	<title>Seamlessly Embedding Matplotlib Output into LaTeX | Sebastian Billaudelle</title>
	<meta name="description" content="In the scientific field, many people use matplotlib for generating plots and then embed the results in their LaTeX document. Why would you want to care about...">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!-- CSS -->
	<link rel="stylesheet" href="/css/main.css">
	
	<!--Favicon-->
	<link rel="shortcut icon" href="/img/avatar2.png" type="image/x-icon">
	
	<!-- Canonical -->
	<link rel="canonical" href="http://sbillaudelle.de/2015/02/23/seamlessly-embedding-matplotlib-output-into-latex.html">
	
	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Sebastian Billaudelle" href="http://sbillaudelle.de/feed.xml" />
	
	<!-- Font Awesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
	
	<!-- Google Fonts -->
	<link href='http://fonts.googleapis.com/css?family=Fira Sans' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Fira Mono' rel='stylesheet' type='text/css'>

	<script src="https://apis.google.com/js/platform.js" async defer>
		{lang: 'de'}
	</script>

	
	<!-- Google Analytics -->
	
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38002709-1', 'auto');
    ga('send', 'pageview');

	</script>
	

	<!-- MooTools -->
	<script src="https://ajax.googleapis.com/ajax/libs/mootools/1.5.1/mootools-yui-compressed.js" defer></script>
	<script src="/script/gallery.js" defer></script>
</head>


  <body>
    <header class="site-header">

	<div class="branding">
		
		<a href="/">
      <img class="avatar" src="/img/avatar.jpg" alt=""/>
    </a>
		
		
		<h1 class="site-title">
			<a href="/">Sebastian Billaudelle</a>
		</h1>
	</div>
	
	<nav class="site-nav">
		<ul>
			
				
			
				
				<li>
					<a class="page-link" href="/about/">About</a>
				</li>
				
			
				
			
				
				<li>
					<a class="page-link" href="/imprint/">Imprint</a>
				</li>
				
			
				
			
				
			
				
				<li>
					<a class="page-link" href="/projects/">Projects</a>
				</li>
				
			
		</ul>
	</nav>
	
</header>


    <div class="content">
      <article >

<header>
    <h1 class="title">Seamlessly Embedding Matplotlib Output into LaTeX</h1>
    
    <p class="meta">
    February 23, 2015
    
    </p>
  </header>
  <section class="post-content">
    <p>In the scientific field, many people use <a href="http://matplotlib.org/">matplotlib</a> for generating plots and then embed the results in their LaTeX document. Why would you want to care about the actual format of the plot graphics? There is of course one obviously bad choice: pixel graphics. Compared to other formats their file size is huge and they don’t scale well at all. “So how about PDF files? I mean, isn’t that a some kind of a vector format?”, you might ask. Good question! I love PDFs and yes, with a few exceptions (for example <code class="highlighter-rouge">plt.imshow</code>) matplotlib writes vector data into <code class="highlighter-rouge">.pdf</code> files. It’s definitely a good way to preview and store a standalone plot and exchange it with others. But you would not want to embed a matplotlib PDF export in your beautiful LaTeX document. The following paragraphs might explain, why you might to change your existing workflow…</p>

<p>By default matplotlib uses its own, custom text and math rendering system called <a href="http://matplotlib.org/users/mathtext.html#mathtext-tutorial">mathtext</a>. Even if you make use of the <code class="highlighter-rouge">text.usetex</code> setting and your <code class="highlighter-rouge">matplotlibrc</code> is set up to match your LaTeX document font settings – which it probably isn’t –, there’s a chance that your beautiful figure will look like a fish out of water. Luckily, matplotlib has built-in support for generating LaTeX code. To be more precise, it is able to dump your plot as a bunch of <a href="https://www.ctan.org/pkg/pgf">PGF</a> commands. There are multiple advantages to this solution:</p>

<ul>
  <li>Your figure will have exactly the size you have specified either in your <code class="highlighter-rouge">matplotlibrc</code> or manually in your plotting code. You don’t need to worry about the width of your figure when including it into your document.</li>
  <li>Everything is rendered by LaTeX. And that is even in the same run as the rest of your document. This ensures that your figures and text look and feel consistent.</li>
  <li>LaTeX will use the same fonts for your plots that you have selected for everything else in the document. You don’t even have to care about that when you generate your plot. To be precise, it uses the <em>sans font</em> for displaying your labels and whichever <em>math font</em> you have chosen for formulas and other mathematical expressions.</li>
</ul>

<p>To let the PGF backend use your document’s fonts, you need to add just a single line to your <code class="highlighter-rouge">matplotlibrc</code> – or set those options from within your script:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">pgf</span><span class="o">.</span><span class="n">rcfonts</span> <span class="p">:</span> <span class="bp">False</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>You can configure a LaTeX preamble for <code class="highlighter-rouge">.pdf</code> and <code class="highlighter-rouge">.png</code> output generated with the PGF backend. This way, your fonts of choice can be set up for standalone plots. This however will not have any influence on plots embedded into your LaTeX files. In my previous post <a href="sbillaudelle.de/2015/02/20/matplotlib-with-style.html">Matplotlib with Style</a>, I introduced my custom styling including a reasonable set of fonts. You might want to check that out!</p>

<p>In your plotting script, you don’t have to change anything except for the file’s extension. I would recommend to save the figure as a <code class="highlighter-rouge">.pgf</code> as well as a <code class="highlighter-rouge">.pdf</code> file. This way you can preview the plot by simply opening the PDF and use the other one for embedding.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># set up figure size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>

<span class="c"># do some plotting here</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># save to file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'example.pdf'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'example.pgf'</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>In your LaTeX document, you now can simply embed the <code class="highlighter-rouge">.pgf</code> file by using <code class="highlighter-rouge"><span class="k">\input</span><span class="p">{</span>…<span class="p">}</span></code>.</p>

<figure class="highlight"><pre><code class="language-latex" data-lang="latex"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="nt">\begin{figure}</span>
	<span class="nt">\begin{center}</span>
		<span class="k">\input</span><span class="p">{</span>path/to/example.pgf<span class="p">}</span>
	<span class="nt">\end{center}</span>
	<span class="k">\caption</span><span class="p">{</span>Example figure proudly made with matplotlib's PGF backend.<span class="p">}</span>
<span class="nt">\end{figure}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>And that’s it. Easy, right? I hope this post did enlighten you and you will never embed your plots using a PDF file or even a pixel graphic. Please help me to improve this article by sending me feedback. I would love to hear about your plotting adventures!</p>

  </section>
  
</article>

<!-- Disqus -->

<div class="comments">
  <div id="disqus_thread"></div>
<script type="text/javascript">
	var disqus_shortname = 'sbillaudelle'; 
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


    </div>

    
<footer class="site-footer">
	<p class="text">Powered by <a href="http://jekyllrb.com">Jekyll</a> with <a href="https://rohanchandra.github.io/project/type/">Type Theme</a>
</p>
</footer>

  </body>
  
</html>
